## 实现虚拟主机的四种方式

目前各种云服务，很大程度上都跟 **虚拟主机** 或者说 **共享主机** 有关，现在我们就来说说这个虚拟主机。

在多年以前，网站还是有钱的大公司玩的东东，因为以前网站都是：自行购买硬件，自行搭建主机，自行申请网络连接，部署服务器软件，自行做好安全防护等等，成本可想而知。

到了现在，越来愈多的人使用网络，越来越多的小公司和个人都想搭建自己的站点，正式因为这种需求就催生了各种云服务提供商，这些云服务上再软硬件上都是杠杠滴靠谱。然而提供的服务费用也比自行搭建便宜的多，而且还是按需购买、什么时候需要什么时候购买，无论从安全、价格、可靠性、伸缩性、扩展性上说都是非常给力的。

但是，并不是这些服务提供商买硬件时脸大就便宜，这一切很大程度上要感谢**虚拟世界**的丰富多彩。下面进入正文说说 **虚拟主机**  

目前实现虚拟主机主要有下面四种方式/技术：

1. ### 通过URL路径进行虚拟主机实现

    这种方式就是向路径中添加专门的`路径部分`，以便服务器判断是要访问那个网站
    
    例如：
    
    * Asite 的URL：http://www.xxxx.com/`asite`/index.html   
    * Bsite 的URL：http://www.xxxx.com/`bsite`/index.html
    
    这是一种槽糕的方案，现实中很少会用到   
    
2. ### 通过端口号实现虚拟主机   

    通过对不同的网站指定不同的端口号，实现虚拟主机。    
    
    例如：  
    
    * Asite 的URL：http://www.xxxx.com:`8080`/index.html   
    * Bsite 的URL：http://www.xxxx.com:`8090`/index.html
    
    这种方式的确定时，需要用户输入端口号，这在对于普通用户来说一点都不友好，而且我们也不能指望普通用户会这么聪明的做准确。   
    
3. ### 通过IP地址实现虚拟主机   

    通过IP地址进行虚拟化是一个更常用、更好的方法。
    
    例如：  
    
    * 当我们访问：Asite 的URL：http://www.asite.com/index.html 时，查询到对应IP：`209.172.34.3`   
    * 当我们访问：Bsite 的URL：http://www.bsite.com/index.html 时，查询到对应IP：`209.172.34.4`
    * 当浏览器打开到虚拟主机的TCP链接时，会根据目标IP的不同实现访问不同的网站
    
4. ### 通过Host首部实现虚拟主机

    基于Http/1.1中请求首部`host`的不同实现虚拟主机，这里需要注意的是：由于http/1.0时代，都是一个IP一台物理机，当时HTTP的设计者并没有考虑到日后的 **虚拟时代**，http/1.0的请求中只是提到 `GET /index.html`, URL中的主机名被当做冗余信息剥离了，只要求发送路径部分。
    
    通过host实现虚拟主机是比较好理解的:服务器获取请求头部信息中的主机名(URL中包含主机名或host的值，URL中主机名优先)  
     